<div id="logo">
  <%= image_tag("ls4.jpg", alt: "Luke Schoen", width: "55", height: "55") %>
</div>

<div class="social-media">

  <a href="https://plus.google.com/u/0/103113786777929863499" target="_blank" class="google">google</a>
  <a href="https://twitter.com/ltfschoen" target="_blank" class="twitter">twitter</a>
  <a href="http://www.linkedin.com/in/ltfschoen" target="_blank" class="linkedin">linkedin</a>
  <a href="https://github.com/ltfschoen" target="_blank" class="github">github</a>
  <a href="http://lukeschoen.blogspot.com.au/" target="_blank" class="blogspot">blogspot</a>
</div>

<div id="periods">
  <a href="#" class="button">
      <span class="arrow">
          <%= image_tag("_minus.jpg", alt: "-", width: "55", height: "55") %>
      </span>
      <span class="arrow" style="display: none;">
          <%= image_tag("_plus.jpg", alt: "+", width: "55", height: "55") %>
      </span>
  </a>
</div>

<div id="columns">
  <ul ng-repeat="website in websites">
    <!-- hood refers to the black header colour -->
    <li ng-mouseover="disableHood(website)" ng-mouseleave="enableHood(website)">
      <!-- <span ng-show="website.editable"><header>{{website.id}}</header></span> -->
      <!-- list of website buttons -->
      <a id="{{website.id}}" ng-href="{{website.url}}" target="new">
        <!-- class id looks up CSS to determines thumbnail to be shown -->
        <div class="column {{website.id}}">
          <header>{{website.name}}</header>
        </div>
      </a>
    </li>
  </ul>
</div>

<!-- START ADSENSE - ADSENSE TEMPORARILY DISABLED AS ERRONEOUS -->
<%# if Rails.env.production? %>

<!-- adsense -->
<!-- lukeschoen.herokuapp.com-bottom-ad -->
<!-- <div data-ads>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
     style="display:inline-block;width:320px;height:50px"
     data-ad-client="ca-pub-3774443777675026"
     data-ad-slot="9950770596"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div> -->

<%# end %>

<!-- END ADSENSE -->

<script>
  
  $(document).ready(function(){
    $("#columns").show();

    $(".button").click(function () {
      $(this).children(".arrow").toggle();
      $("#columns").toggle();
            return false;
    });
  });

  // Feature detection using Modernizr library to check for DnD
  if (Modernizr.draganddrop) {
    // Browser supports HTML5 DnD.
  } else {
    // Fallback to a library solution.
  }

  // DataTransfer property holds data sent in drag action
  var dragSrcEl = null;

  function handleDragStart(e) {
    this.style.opacity = '0.4';  // this / e.target is source node.
    
    dragSrcEl = this;

    e.dataTransfer.effectAllowed = 'move';
    // set object content to mimetype
    // data payload of source column HTML passed as args
    e.dataTransfer.setData('text/html', this.innerHTML);
  }

  function handleDragOver(e) {
    if (this.innerHTML) { // somehow allows links to appear
      if (e.preventDefault) {
        e.preventDefault(); // allows dropping instead of link
      }

      e.dataTransfer.dropEffect = 'move';  // see DataTransfer object
      return false;
    }
  }

  function handleDragEnter(e) {
    // this / e.target is current hover target.
    this.classList.add('over');
  }

  function handleDragLeave(e) {
    // this / e.target is previous target element.
    this.classList.remove('over');  
  }

  function handleDrop(e) {
    // this / e.target is current target element.
    if (e.stopPropagation) {
      e.stopPropagation(); // stops browser from redirecting.
    }

    // no action if dropping same column being dragged
    if (dragSrcEl != this) {
      // set source column HTML to HTML of column we dropped on
      dragSrcEl.innerHTML = this.innerHTML;
      this.innerHTML = e.dataTransfer.getData('text/html');
    }

    // see DataTransfer object.
    return false;
  }

  function handleDragEnd(e) {
    // this/e.target is the source node.
    [].forEach.call(cols, function (col) {
      col.classList.remove('over');
    });
  }

  var cols = document.querySelectorAll('#columns .column');
  [].forEach.call(cols, function(col) {
    col.addEventListener('dragstart', handleDragStart, false);
    col.addEventListener('dragenter', handleDragEnter, false);
    col.addEventListener('dragover', handleDragOver, false);
    col.addEventListener('dragleave', handleDragLeave, false);
    col.addEventListener('drop', handleDrop, false);
    col.addEventListener('dragend', handleDragEnd, false);
  });

</script>